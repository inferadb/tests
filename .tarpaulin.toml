# Tarpaulin Configuration for InferaDB Management API
# Code coverage testing configuration
#
# Usage:
#   cargo tarpaulin                    # Run with default config
#   cargo tarpaulin --out Html         # Generate HTML report
#   cargo tarpaulin --out Lcov         # Generate lcov for CI

[default]
# Target coverage percentage (aim for >90%)
fail-under = 80.0

# Output formats
out = ["Html", "Xml"]

# Exclude patterns
exclude = ["*/tests/*", "*/test_fixtures/*", "*/benches/*"]

# Exclude files from coverage
exclude-files = ["crates/*/tests/*", "crates/infera-management-test-fixtures/*"]

# Run type
run-types = ["Tests"]

# Timeout for tests (seconds)
timeout = 300

# Count hits (for better accuracy)
count = true

# Follow test executables
follow-exec = false

# Workspace mode
workspace = true

# Target directory
target-dir = "target"

# Separate multiple output files
output-dir = "target/coverage"

# Exclude main functions and mod declarations
ignore-panics = true

# Include branch coverage
branch = true

# Show verbose output
verbose = false

# Skip clean (faster for iterative testing)
skip-clean = false

# Force clean build
force-clean = false

# Include doc tests
include-tests = false

# Don't fail on timeout
fail-on-timeout = false

# Cargo all features
all-features = false

# Exclude specific crates if needed
# exclude-crates = []

# JSON output for machine parsing
[json]
out = ["Json"]
output-dir = "target/coverage"

# CI-friendly minimal output
[ci]
out = ["Lcov"]
output-dir = "target/coverage"
timeout = 600
verbose = true
fail-under = 80.0
